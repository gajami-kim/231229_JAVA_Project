<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        button img{
            width: 200px;
            height: 200px;
            background-color: white;
        }
        button{
            background-color: white;
            cursor: pointer;
        }
        button p{
            font-size: 20px;
            margin: 0 0 10px;
        }
        div{
            font-size: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <button type="button" onclick="play(1)"><img src="/image/scissors.png" alt=""><p>가위(1)</p></button>
    <button type="button" onclick="play(2)"><img src="/image/rock.png" alt=""><p>바위(2)</p></button>
    <button type="button" onclick="play(3)"><img src="/image/paper.png" alt=""><p>보(3)</p></button>
    <h3 id="result"></h3>

    <script>
        //누적변수선언
        let playerState=0; //숫자상태
        let playerStateChar = ''; //문자상태
        let comState=0; //숫자상태
        let comStateChar = ''; //문자상태
        let win=0;
        let draw = 0;
        let lose = 0;
        let r1 = ''; //결과문자
        let result = 0;

        function play(player){
            console.log(player);
            if(player ==1) {
                playerState=1;
                playerStateChar='가위';
            } else if(player==2){
                playerState=2;
                playerStateChar='바위';
            } else {
                playerState=3;
                playerStateChar='보';
            }

            setComState(); //컴상태
            setDistinct(); //결과호출
            showResult(); //결과출력
        }

        // 결과 출력 : result 0(무승부) 1(승) -1(패)
        function setDistinct(){
            if(playerState==comState){
                result=0;
            } else {
                if(playerState==1){
                    comState==2 ? result = -1 : result = 1;
                } else if(playerState==2) {
                    comState==3 ? result = -1 : result = 1;
                } else if(playerState==3){
                    comState==1 ? result = -1 : result = 1;
                }
            }
        }

        //화면 출력
        function showResult() {
            if(result == -1){//패   \n : 줄바꿈
                lose++;
                show(result);
            } else if(result==1){
                win++;
                show(result);
            } else {
                draw++;
                show(result);
            }
            document.getElementById('result').innerHTML = r1;
        }
        
        function show(result){
            r1 = `player:${playerStateChar} / com:${comStateChar} `;
            r1 += `player가 ${result==1 ? '이겼습니다.\n' : result==0 ? '비겼습니다.\n' : '졌습니다.\n'}`;
            r1 += `현재전적 \n 승:${win} /  무:${draw} / 패:${lose} \n`;
            r1 += `승률:${getWinRate().toFixed(2)}%`;
        }

        //승률 (win / 전체경기수) * 100
        function getWinRate(){
            return(win != 0) ? (win / (win+draw+lose))*100 : 0;
        }

        //컴퓨터의 랜덤 값 생성 상태 저장
        function setComState(){
            comState = Math.floor(Math.random()*3)+1;
            switch(comState){
                case 1: comStateChar='가위'; break;
                case 2: comStateChar='바위'; break;
                case 3: comStateChar='보'; break;
            }
        }
    </script>
</body>
</html>